---
import type { HTMLAttributes } from 'astro/types';

type Props = HTMLAttributes<'a'> & {
  href: string;
};

const { href, class: className, ...props } = Astro.props;
const base = import.meta.env.BASE_URL ?? '/';

// Validar que href existe y construir la URL completa
if (!href) {
  throw new Error('HeaderLink component requires an href prop');
}

// Agregar base a todos los hrefs (excepto URLs externas o que ya tengan base)
let fullHref = href;
if (href.startsWith('/')) {
  fullHref = base !== '/' ? base + href.slice(1) : href;
} else if (!href.startsWith('http') && !href.startsWith('#') && !href.startsWith('mailto:')) {
  // Para rutas relativas sin / inicial
  fullHref = base !== '/' ? base + href : '/' + href;
}

// Comparar rutas completas
const isActive = Astro.url.pathname === fullHref;
---

<a href={fullHref} class:list={[className, { active: isActive }]} {...props}>
  <slot />
</a>
<style>
  a {
    display: inline-block;
    text-decoration: none;
  }
  a.active {
    font-weight: bolder;
    text-decoration: underline;
  }
</style>